```markdown
# ğŸ› ï¸ VenTech Backend

A **Node.js + Express backend** powered by **Firebase Authentication** and **MongoDB (Mongoose ORM)**.  
This backend handles **authentication, user management, merchant workflows, product management, categories, blogs, and mailbox support**.

---

## ğŸš€ Features

- **Authentication**
  - Firebase Admin for verifying ID tokens
  - Auto-create users on first login
  - Role-based access control (Customer, Merchant, Admin)

- **User Management**
  - Add / update users
  - Request merchant role
  - Approve / reject merchant role (Admin)
  - Admin can list / delete users

- **Merchant Workflow**
  - Merchant role request + approval flow
  - Restricted routes for merchants

- **Products**
  - CRUD operations for products
  - Merchant-only product creation
  - Stock management (update / stock out)
  - Request other merchantâ€™s product
  - Public + private product endpoints

- **Categories**
  - CRUD operations for categories
  - Public category listing

- **Blog**
  - Fetch all blogs / single blog
  - (Create, update, delete routes exist but commented for now)

- **Mailbox**
  - Save contact form messages
  - Public API to fetch all messages

- **Healthcheck**
  - `/api/v1/health` endpoint for quick status check

---

## ğŸ“‚ Project Structure

```

.
â”œâ”€â”€ index.js              # Main entry point
â”œâ”€â”€ admin-key.json        # Firebase Admin SDK credentials
â”œâ”€â”€ models/               # (Schemas and models inside index.js)
â”œâ”€â”€ .env                  # Environment variables
â””â”€â”€ package.json          # Dependencies

````

---

## âš™ï¸ Tech Stack

- **Runtime**: Node.js + Express
- **Database**: MongoDB + Mongoose
- **Auth**: Firebase Admin SDK
- **Validation**: Zod
- **Other**: dotenv, cors, path

---

## ğŸ“¦ Dependencies

Main dependencies used:

```json
"dependencies": {
  "cors": "^2.x",
  "dotenv": "^16.x",
  "express": "^4.x",
  "firebase-admin": "^12.x",
  "mongoose": "^7.x",
  "zod": "^3.x"
}
````

---

## ğŸ”‘ Environment Variables

Create a `.env` file in the project root:

```env
PORT=3000
MONGODB_URI_PATH=mongodb+srv://your-user:password@cluster.mongodb.net
```

Youâ€™ll also need **`admin-key.json`** from Firebase Console:

* Go to Firebase â†’ Project Settings â†’ Service Accounts â†’ Generate Private Key

---

## ğŸƒ Installation & Running

Clone the repo and install dependencies:

```bash
git clone https://github.com/your-username/ventech-backend.git
cd ventech-backend
npm install
```

Start the development server:

```bash
npm run start
```

or with nodemon (if installed globally):

```bash
nodemon index.js
```

---

## ğŸ” Authentication

All protected routes require a **Firebase ID Token** in the request headers:

```http
Authorization: Bearer <firebase-id-token>
```

Use Firebase client SDK in your frontend to get the token after login.

---

## ğŸ“¡ API Endpoints

### Health

* `GET /api/v1/health` â†’ Check server & DB connection

### Auth

* `GET /api/v1/auth/me` â†’ Get logged-in user
* `POST /api/v1/auth/add-user` â†’ Add or update user
* `POST /api/v1/auth/request-merchant` â†’ Customer requests merchant role

### Admin

* `GET /api/v1/admin/users` â†’ List all users (non-admins)
* `DELETE /api/v1/admin/users/:id` â†’ Delete user
* `PATCH /api/v1/admin/approve-merchant/:id` â†’ Approve merchant request
* `PATCH /api/v1/admin/reject-merchant/:id` â†’ Reject merchant request
* `GET /api/v1/admin/pending-merchants` â†’ List pending merchant requests

### Products

* `POST /api/v1/products` â†’ Add product (merchant only)
* `GET /api/v1/products` â†’ List all products (auth required)
* `GET /api/v1/products/public` â†’ List all products (public)
* `GET /api/v1/products/:id` â†’ Get single product
* `PATCH /api/v1/products/:id/edit` â†’ Edit product (merchant or admin)
* `DELETE /api/v1/products/:id` â†’ Delete product (merchant or admin)
* `PATCH /api/v1/products/:id/update-stock` â†’ Update stock
* `PATCH /api/v1/products/:id/stock-out` â†’ Mark as out-of-stock
* `POST /api/v1/products/:id/request` â†’ Request another merchantâ€™s product

### Categories

* `GET /api/v1/categories` â†’ List categories
* `POST /api/v1/categories` â†’ Add category
* `PATCH /api/v1/categories/:id` â†’ Update category

### Blog

* `GET /api/v1/blogs` â†’ List all blogs
* `GET /api/v1/blogs/:id` â†’ Get single blog
* *(create, update, delete available but commented out)*

### Mailbox

* `POST /api/public/mailbox` â†’ Save contact form message
* `GET /api/public/mailbox` â†’ Fetch all messages

---

## ğŸ“– Notes

* First login automatically creates a user with role `customer`.
* Merchant requests are stored in `roleRequest` field until approved by an Admin.
* `shopDetails` is optional for merchants.
* Default user avatar is set automatically.
* Blog CRUD is **disabled for now** (commented).

---

## âœ… Future Improvements

* Add refresh token + session management
* Enable full blog CRUD
* Add product search + filtering
* Implement product request persistence between merchants
* Improve validation layer with Zod on all routes

---

## ğŸ‘¨â€ğŸ’» Author

**VenTech Backend** â€“ built with â¤ï¸ by [Your Name](https://github.com/your-username)

