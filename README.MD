# ğŸ› ï¸ VenTech Backend - Node.js + Express API

A **Node.js + Express backend** for the **VenTech Multi-Vendor Marketplace**, handling **authentication, user management, merchant onboarding, product management, categories, blogs (partial), mailbox support**, built with **Firebase Authentication**, **MongoDB (Mongoose)**, and **Zod validation** with **role-based access control** for **Customer, Merchant, and Admin**.

---

## ğŸš€ Features

### ğŸ”‘ Authentication & User Management
- Firebase Admin SDK for verifying ID tokens
- Automatic user creation on first login
- Role-based access control: Customer / Merchant / Admin
- Profile update support
- Track login count per user

### ğŸ›’ Merchant Workflow
- Customers can request merchant role
- Admin approval/rejection for merchant accounts
- Pending merchant requests listing (admin only)
- Merchant-only restricted endpoints

### ğŸ“¦ Products
- Product CRUD (Create, Read, Update, Delete)
- Merchant-only product creation
- Public & protected product listings
- Stock management: update / mark out of stock
- Request other merchantâ€™s products

### ğŸ—‚ï¸ Categories
- Create, read, update categories
- Public category listing

### ğŸ“° Blog (Basic)
- Fetch all blogs or single blog
- Blog CRUD routes currently disabled

### ğŸ“¬ Mailbox
- Save contact form messages
- Fetch messages via public API

### ğŸ©º Healthcheck
- `/api/v1/health` â†’ server + DB status

---

## ğŸ“‚ Project Structure

```bash
.
â”œâ”€â”€ index.js          # Main backend entry point
â”œâ”€â”€ admin-key.json    # Firebase Admin SDK credentials
â”œâ”€â”€ .env              # Environment variables
â”œâ”€â”€ package.json      # Dependencies
â””â”€â”€ (models defined inside index.js for now)
```

---

## âš™ï¸ Tech Stack

- Node.js + Express
- MongoDB + Mongoose
- Firebase Admin SDK
- Zod validation
- dotenv, cors, path

---

## ğŸ”‘ Environment Variables

```env
PORT=3000
MONGODB_URI_PATH=mongodb+srv://your-user:password@cluster.mongodb.net/ventech_db
```

Also require **admin-key.json** from Firebase â†’ Project Settings â†’ Service Accounts â†’ Generate Private Key.

---

## ğŸƒ Installation & Run

```bash
git clone https://github.com/aashikur/VenTech_v2.0-server.git
cd VenTech_v2.0-server
npm install
npm run start
```

With nodemon:

```bash
nodemon index.js
```

---

## ğŸ” Authentication

Protected routes require **Firebase ID Token** in headers:

```http
Authorization: Bearer <firebase-id-token>
```

---

## ğŸ“¡ API Endpoints

### Health
- `GET /api/v1/health` â†’ Check server & DB status

### Auth
- `GET /api/v1/auth/me` â†’ Get logged-in user
- `PATCH /api/v1/auth/update-profile` â†’ Update profile
- `POST /api/v1/auth/request-merchant` â†’ Request merchant role

### Admin
- `GET /api/v1/admin/pending-merchants` â†’ List pending merchant requests
- `PATCH /api/v1/admin/approve-merchant/:id` â†’ Approve merchant
- `PATCH /api/v1/admin/reject-merchant/:id` â†’ Reject merchant

### Products
- `GET /api/v1/products/public` â†’ List all products (public)
- `GET /api/v1/products` â†’ List all products (protected)
- `POST /api/v1/products` â†’ Add product (merchant only)
- `PATCH /api/v1/products/:id/edit` â†’ Edit product (merchant/admin)
- `PATCH /api/v1/products/:id/update-stock` â†’ Update stock
- `PATCH /api/v1/products/:id/stock-out` â†’ Mark out of stock
- `DELETE /api/v1/products/:id` â†’ Delete product (merchant/admin)
- `POST /api/v1/products/:id/request` â†’ Request another merchant's product

### Categories
- `GET /api/v1/categories` â†’ List categories
- `POST /api/v1/categories` â†’ Create category
- `PATCH /api/v1/categories/:id` â†’ Update category

### Blog
- `GET /api/v1/blogs` â†’ Get all blogs
- `GET /api/v1/blogs/:id` â†’ Get single blog

### Mailbox
- `POST /api/public/mailbox` â†’ Save contact message
- `GET /api/public/mailbox` â†’ Get all messages

### Request List
- `POST /api/v1/request-list` â†’ Create request to another merchant
- `GET /api/v1/request-list` â†’ List all requests

---

## âœ… Notes
- First login auto-creates a customer user
- Merchant requests stored in `roleRequest` until approved
- Admin approval required before merchant can add products
- `shopDetails` optional for merchants
- Blog CRUD disabled (fetch-only)

---

## ğŸ‘¨â€ğŸ’» Author

**VenTech Backend** â€“ built with â¤ï¸ by [Ashikur Rahaman](https://github.com/aashikur)
