{"canmore.create\_textdoc": {"name": "README", "type": "document", "content": "# VenTech Backend\n\nThis project is the **backend for VenTech**, built with **Node.js, Express, MongoDB, and Firebase Authentication**. It provides APIs for authentication, user management, merchant approval, product management, categories, mailbox, and blogs.\n\n---\n\n## ğŸš€ Features\n\n### ğŸ” Authentication & Authorization\n- **Firebase Authentication** integrated with `firebase-admin`.\n- **Auth Middleware**:\n  - `requireAuth`: Validates Firebase token, creates user if not exists, updates login count.\n  - `requireMerchant`: Ensures only merchants can access certain routes.\n  - `requireAdmin`: Restricts routes to admin only.\n\n### ğŸ‘¤ User Management\n- Users are stored in **MongoDB** with details:\n  - Name, email, phone, photoURL\n  - Roles: `admin`, `merchant`, `customer`\n  - Status: `active`, `pending`, `blocked`\n  - Role requests (merchant application system)\n  - Shop details (for merchants)\n- APIs:\n  - `POST /api/v1/auth/add-user` â†’ Create or update user\n  - `GET /api/v1/auth/me` â†’ Get logged-in user details\n  - `POST /api/v1/auth/request-merchant` â†’ Customers request merchant role\n\n### ğŸ›  Admin Features\n- Approve or reject merchant role requests.\n- Manage users (list, delete).\n- APIs:\n  - `GET /api/v1/admin/users` â†’ Get all users (non-admin)\n  - `PATCH /api/v1/admin/approve-merchant/:id` â†’ Approve merchant\n  - `PATCH /api/v1/admin/reject-merchant/:id` â†’ Reject merchant\n  - `DELETE /api/v1/admin/users/:id` â†’ Delete user\n  - `GET /api/v1/admin/pending-merchants` â†’ List pending merchant requests\n\n### ğŸ“¬ Mailbox\n- Public contact form storage.\n- APIs:\n  - `POST /api/public/mailbox` â†’ Save message\n  - `GET /api/public/mailbox` â†’ Retrieve all messages\n\n### ğŸ“‚ Categories\n- Categories stored in MongoDB.\n- APIs:\n  - `GET /api/v1/categories` â†’ List categories\n  - `POST /api/v1/categories` â†’ Add category\n  - `PATCH /api/v1/categories/:id` â†’ Update category\n\n### ğŸ“¦ Products\n- Products linked to merchants.\n- Product schema includes:\n  - Title, description, category, images\n  - Retail & merchant price\n  - Quantity & stock status\n  - Merchant ID reference\n- APIs:\n  - `POST /api/v1/products` â†’ Create product (merchant only)\n  - `GET /api/v1/products` â†’ List all products (auth required)\n  - `GET /api/v1/products/public` â†’ Public products list\n  - `GET /api/v1/products/:id` â†’ Get product by ID\n  - `PATCH /api/v1/products/:id/update-stock` â†’ Update stock (merchant only)\n  - `PATCH /api/v1/products/:id/stock-out` â†’ Mark product out of stock\n  - `POST /api/v1/products/:id/request` â†’ Request another merchant's product\n  - `PATCH /api/v1/products/:id/edit` â†’ Edit product (merchant or admin)\n  - `DELETE /api/v1/products/:id` â†’ Delete product (merchant or admin)\n\n### ğŸ“ Blog\n- Blogs stored in MongoDB.\n- APIs:\n  - `GET /api/v1/blogs` â†’ Get all blogs\n  - `GET /api/v1/blogs/:id` â†’ Get blog by ID\n  - *(Commented but available to enable)* Create, update, and delete blogs\n\n---\n\n## âš™ï¸ Tech Stack\n- **Node.js + Express** â†’ API server\n- **MongoDB + Mongoose** â†’ Database\n- **Firebase Admin SDK** â†’ Authentication\n- **Zod** â†’ Validation\n- **CORS + dotenv** â†’ Middleware & configuration\n\n---\n\n## ğŸ“¦ Project Structure\n`\nproject/\nâ”œâ”€â”€ index.js              # Main backend entry\nâ”œâ”€â”€ admin-key.json        # Firebase service account key (gitignored)\nâ”œâ”€â”€ .env                  # Environment variables\nâ””â”€â”€ package.json\n`\n\n---\n\n## ğŸ”‘ Environment Variables\nCreate a `.env` file with:\n`env\nPORT=3000\nMONGODB_URI_PATH=mongodb+srv://<your-mongo-uri>\n`\n\nAlso ensure you have a `admin-key.json` for Firebase Admin SDK.\n\n---\n\n## â–¶ï¸ Getting Started\n\n### 1ï¸âƒ£ Install dependencies\n`bash\nnpm install\n`\n\n### 2ï¸âƒ£ Start MongoDB\nEnsure you have a MongoDB cluster (Atlas or local).\n\n### 3ï¸âƒ£ Run server\n`bash\nnpm start\n`\nServer runs at:\n`\nhttp://localhost:3000\n`\n\n---\n\n## ğŸ§ª Testing APIs\nYou can test endpoints using:\n- **Postman**\n- **cURL**\n- **Frontend client** (React, etc.)\n\nFor protected routes, include Firebase Auth **Bearer token** in `Authorization` header.\n`\nAuthorization: Bearer <firebase-id-token>\n`\n\n---\n\n## ğŸ“– Notes\n- Admin role must be set manually in DB for the first user.\n- Merchants need approval by an admin after submitting request.\n- Default role: **customer**.\n- Products can only be added by approved merchants.\n- Blogs currently only support fetching; write operations are disabled but can be enabled.\n\n---\n\n## âœ… Health Check\nTest if server is running:\n`\nGET /api/v1/health\n`\nResponse:\n`json\n{\n  \"ok\": true,\n  \"db\": \"ventech_db\"\n}\n`\n\n---\n\n## ğŸ“Œ Summary\nThis backend supports **user roles, merchant requests, product & category management, mailbox, and blogs**. Itâ€™s designed to integrate with a frontend (React, Next.js, etc.) and uses Firebase for authentication.\n"} }
    