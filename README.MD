{"canmore.create\_textdoc": {"name": "README", "type": "document", "content": "# VenTech Backend\n\nThis project is the **backend for VenTech**, built with **Node.js, Express, MongoDB, and Firebase Authentication**. It provides APIs for authentication, user management, merchant approval, product management, categories, mailbox, and blogs.\n\n---\n\n## 🚀 Features\n\n### 🔐 Authentication & Authorization\n- **Firebase Authentication** integrated with `firebase-admin`.\n- **Auth Middleware**:\n  - `requireAuth`: Validates Firebase token, creates user if not exists, updates login count.\n  - `requireMerchant`: Ensures only merchants can access certain routes.\n  - `requireAdmin`: Restricts routes to admin only.\n\n### 👤 User Management\n- Users are stored in **MongoDB** with details:\n  - Name, email, phone, photoURL\n  - Roles: `admin`, `merchant`, `customer`\n  - Status: `active`, `pending`, `blocked`\n  - Role requests (merchant application system)\n  - Shop details (for merchants)\n- APIs:\n  - `POST /api/v1/auth/add-user` → Create or update user\n  - `GET /api/v1/auth/me` → Get logged-in user details\n  - `POST /api/v1/auth/request-merchant` → Customers request merchant role\n\n### 🛠 Admin Features\n- Approve or reject merchant role requests.\n- Manage users (list, delete).\n- APIs:\n  - `GET /api/v1/admin/users` → Get all users (non-admin)\n  - `PATCH /api/v1/admin/approve-merchant/:id` → Approve merchant\n  - `PATCH /api/v1/admin/reject-merchant/:id` → Reject merchant\n  - `DELETE /api/v1/admin/users/:id` → Delete user\n  - `GET /api/v1/admin/pending-merchants` → List pending merchant requests\n\n### 📬 Mailbox\n- Public contact form storage.\n- APIs:\n  - `POST /api/public/mailbox` → Save message\n  - `GET /api/public/mailbox` → Retrieve all messages\n\n### 📂 Categories\n- Categories stored in MongoDB.\n- APIs:\n  - `GET /api/v1/categories` → List categories\n  - `POST /api/v1/categories` → Add category\n  - `PATCH /api/v1/categories/:id` → Update category\n\n### 📦 Products\n- Products linked to merchants.\n- Product schema includes:\n  - Title, description, category, images\n  - Retail & merchant price\n  - Quantity & stock status\n  - Merchant ID reference\n- APIs:\n  - `POST /api/v1/products` → Create product (merchant only)\n  - `GET /api/v1/products` → List all products (auth required)\n  - `GET /api/v1/products/public` → Public products list\n  - `GET /api/v1/products/:id` → Get product by ID\n  - `PATCH /api/v1/products/:id/update-stock` → Update stock (merchant only)\n  - `PATCH /api/v1/products/:id/stock-out` → Mark product out of stock\n  - `POST /api/v1/products/:id/request` → Request another merchant's product\n  - `PATCH /api/v1/products/:id/edit` → Edit product (merchant or admin)\n  - `DELETE /api/v1/products/:id` → Delete product (merchant or admin)\n\n### 📝 Blog\n- Blogs stored in MongoDB.\n- APIs:\n  - `GET /api/v1/blogs` → Get all blogs\n  - `GET /api/v1/blogs/:id` → Get blog by ID\n  - *(Commented but available to enable)* Create, update, and delete blogs\n\n---\n\n## ⚙️ Tech Stack\n- **Node.js + Express** → API server\n- **MongoDB + Mongoose** → Database\n- **Firebase Admin SDK** → Authentication\n- **Zod** → Validation\n- **CORS + dotenv** → Middleware & configuration\n\n---\n\n## 📦 Project Structure\n`\nproject/\n├── index.js              # Main backend entry\n├── admin-key.json        # Firebase service account key (gitignored)\n├── .env                  # Environment variables\n└── package.json\n`\n\n---\n\n## 🔑 Environment Variables\nCreate a `.env` file with:\n`env\nPORT=3000\nMONGODB_URI_PATH=mongodb+srv://<your-mongo-uri>\n`\n\nAlso ensure you have a `admin-key.json` for Firebase Admin SDK.\n\n---\n\n## ▶️ Getting Started\n\n### 1️⃣ Install dependencies\n`bash\nnpm install\n`\n\n### 2️⃣ Start MongoDB\nEnsure you have a MongoDB cluster (Atlas or local).\n\n### 3️⃣ Run server\n`bash\nnpm start\n`\nServer runs at:\n`\nhttp://localhost:3000\n`\n\n---\n\n## 🧪 Testing APIs\nYou can test endpoints using:\n- **Postman**\n- **cURL**\n- **Frontend client** (React, etc.)\n\nFor protected routes, include Firebase Auth **Bearer token** in `Authorization` header.\n`\nAuthorization: Bearer <firebase-id-token>\n`\n\n---\n\n## 📖 Notes\n- Admin role must be set manually in DB for the first user.\n- Merchants need approval by an admin after submitting request.\n- Default role: **customer**.\n- Products can only be added by approved merchants.\n- Blogs currently only support fetching; write operations are disabled but can be enabled.\n\n---\n\n## ✅ Health Check\nTest if server is running:\n`\nGET /api/v1/health\n`\nResponse:\n`json\n{\n  \"ok\": true,\n  \"db\": \"ventech_db\"\n}\n`\n\n---\n\n## 📌 Summary\nThis backend supports **user roles, merchant requests, product & category management, mailbox, and blogs**. It’s designed to integrate with a frontend (React, Next.js, etc.) and uses Firebase for authentication.\n"} }
    